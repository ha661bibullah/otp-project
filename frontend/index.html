<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>OTP Demo</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;padding:20px;max-width:640px}
    input{padding:8px;margin:6px 0;width:100%}
    button{padding:8px 12px;margin-top:6px}
    pre{background:#f4f4f4;padding:10px}
  </style>
</head>
<body>
  <h1>OTP Demo</h1>

  <section>
    <h3>Send OTP</h3>
    <input id="email" type="email" placeholder="Enter email" />
    <button id="sendBtn">Send OTP</button>
    <p id="sendMsg"></p>
  </section>

  <section>
    <h3>Verify OTP</h3>
    <input id="otp" type="text" placeholder="Enter OTP" />
    <button id="verifyBtn">Verify OTP</button>
    <p id="verifyMsg"></p>
  </section>

  <pre id="debug"></pre>

  <script>
    // DEFAULT for local dev. After deploying backend to Render, replace with your Render URL.
    // Example: const API = "https://otp-backend.onrender.com";
    const API = "http://localhost:5000";

    const el = id => document.getElementById(id);
    el('sendBtn').addEventListener('click', async () => {
      const email = el('email').value.trim().toLowerCase();
      el('sendMsg').textContent = 'Sending...';
      try {
        const r = await fetch(`${API}/send-otp`, {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({ email })
        });
        const data = await r.json();
        el('sendMsg').textContent = data.message || JSON.stringify(data);
        el('debug').textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        el('sendMsg').textContent = 'Failed to send OTP';
        el('debug').textContent = String(err);
        console.error(err);
      }
    });

    el('verifyBtn').addEventListener('click', async () => {
      const email = el('email').value.trim().toLowerCase();
      const otp = el('otp').value.trim();
      el('verifyMsg').textContent = 'Verifying...';
      try {
        const r = await fetch(`${API}/verify-otp`, {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify({ email, otp })
        });
        const data = await r.json();
        el('verifyMsg').textContent = data.message || JSON.stringify(data);
        el('debug').textContent = JSON.stringify(data, null, 2);
      } catch (err) {
        el('verifyMsg').textContent = 'Failed to verify OTP';
        el('debug').textContent = String(err);
        console.error(err);
      }
    });
  </script>
</body>
</html>
